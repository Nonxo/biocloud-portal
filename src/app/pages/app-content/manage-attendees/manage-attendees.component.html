<div class="container">
    <div class="row mt-lg-5 ">
        <div class="col-md-12 mt-4">
            <mat-card class="p-0">
                <h4 class="pt-4 pb-2 align-middle px-3">Attendees List</h4>

                <div class="list-group">
                    <div class="list-group-item list-group-item-action d-flex flex-row align-items-start bg-light-grey">
                        <div class="mt-4">
                            <mat-checkbox (change)="selectAll($event)"></mat-checkbox>
                        </div>
                        <div class="w-100 pl-3">
                            <div class="d-flex w-100 ">
                               <div class="row">
                                   <div class="col-md-6">
                                       <mat-form-field>
                                           <mat-select placeholder="Actions" name="action" [(ngModel)]="action" (change)="groupActions()">
                                               <mat-option value="">--</mat-option>
                                               <ng-container *ngFor="let action of actions">
                                                   <mat-option *ngIf="(orgWideSearch && action.displayFor == 'ALL') || !orgWideSearch" [value]="action.enum">
                                                       {{ action.name }}
                                                   </mat-option>
                                               </ng-container>
                                           </mat-select>
                                       </mat-form-field>
                                   </div>
                                   <div class="col-md-6 ml-auto">
                                       <mat-form-field>
                                           <mat-select placeholder="" name="location" [(ngModel)]="selectedLocId" (change)="fetchUsers()">
                                               <mat-option value ="">ALL</mat-option>
                                               <ng-container *ngFor="let loc of locations">
                                                   <mat-option [value]="loc.locId">
                                                       {{ loc.name }}
                                                   </mat-option>
                                               </ng-container>
                                           </mat-select>
                                       </mat-form-field>
                                   </div>
                               </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="list-group" *ngFor="let d of data let i = index">
                    <div class="list-group-item list-group-item-action d-flex flex-row align-items-start">
                        <div>
                            <mat-checkbox name="check{{i}}" [(ngModel)]="d.checked"></mat-checkbox>
                        </div>
                        <div class="w-100 pl-3">
                            <div class="d-flex w-100 justify-content-between">
                                <p class=" mb-1 font-weight-bold">{{d.firstName }} {{ d.lastName}}</p>
                                <small>
                                    <button mat-icon-button [matMenuTriggerFor]="menu">
                                        <mat-icon>more_horiz</mat-icon>
                                    </button>
                                    <mat-menu #menu="matMenu">
                                        <button *ngIf="!orgWideSearch" mat-menu-item (click)="openAssignModal(assignuserTemplate, d.email)">
                                            <mat-icon>assignment_ind</mat-icon>
                                            <span>Reassign User</span>
                                        </button>
                                        <button mat-menu-item>
                                            <mat-icon>view_list</mat-icon>
                                            <span>View report</span>
                                        </button>
                                        <button mat-menu-item (click)="openActivateUserModal(activateUserTemplate)">
                                            <mat-icon>delete_forever</mat-icon>
                                            <span>Delete</span>
                                        </button>
                                    </mat-menu>
                                </small>
                            </div>
                            <p class="mb-1 d-flex justify-content-between">12 John okafor street Agungi Lekki, Lagos
                                <span class="text-success">Success</span></p>
                        </div>
                    </div>
                </div>
            </mat-card>
        </div>
    </div>
</div>


<ng-template #assignuserTemplate>
    <div class="modal-header">
        <h4 class="modal-title">Reassign Attendee</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row p-md-3 p-0">

            <div class="col-md-12">
                <h6 class="text-brand">Reassign the selected attendee(s) to a new location</h6>
            </div>

            <div class="col-md-8">
                <mat-form-field class="input-field">
                    <mat-select placeholder="Select Location" name="locId" [(ngModel)]="assignRequestObj.newlocId">
                        <mat-option value="0">--</mat-option>
                        <ng-container *ngFor="let loc of locations">
                        <mat-option *ngIf="selectedLocId !== loc.locId" value="{{loc.locId}}">{{loc.name}}
                        </mat-option>
                        </ng-container>
                    </mat-select>
                </mat-form-field>
            </div>

            <div class="col-md-12 text-right">
                <button mat-raised-button color="danger" type="button" (click)="modalRef.hide()">CANCEL</button>
                <button mat-raised-button color="primary" type="button" (click)="assignUser()">Reassign</button>
            </div>

        </div>
    </div>
</ng-template>

<ng-template #activateUserTemplate>
    <div class="modal-header">
        <h4 class="modal-title pull-left">Modal</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">

        <div class="col-md-12">
            <h6 class="text-brand">Are you sure you want to the selected attendee(s).</h6>
            <h6 class="text-brand">This means they will be unable to clock in to your institution anymore</h6>
        </div>

        <div class="col-md-12 text-right">
            <button mat-raised-button color="danger" type="button">CANCEL</button>
            <button mat-raised-button color="primary" type="button" (click)="activateDeactivateUser()">OK</button>
        </div>


    </div>
</ng-template>
